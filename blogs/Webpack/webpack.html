<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack学习笔记 | 深渊里的小鱼</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/myblog/favicon.ico">
    <meta name="description" content="不断总结，才能进步！">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.8be25012.css" as="style"><link rel="preload" href="/myblog/assets/js/app.2ab9c80a.js" as="script"><link rel="preload" href="/myblog/assets/js/3.5cd8e1a2.js" as="script"><link rel="preload" href="/myblog/assets/js/1.646cc11f.js" as="script"><link rel="preload" href="/myblog/assets/js/6.bed8806e.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.445f0d9a.js"><link rel="prefetch" href="/myblog/assets/js/11.77876120.js"><link rel="prefetch" href="/myblog/assets/js/12.81b8ec37.js"><link rel="prefetch" href="/myblog/assets/js/13.006bef6a.js"><link rel="prefetch" href="/myblog/assets/js/14.074be2af.js"><link rel="prefetch" href="/myblog/assets/js/15.62d84104.js"><link rel="prefetch" href="/myblog/assets/js/16.186732c1.js"><link rel="prefetch" href="/myblog/assets/js/17.70380392.js"><link rel="prefetch" href="/myblog/assets/js/18.3ad61a45.js"><link rel="prefetch" href="/myblog/assets/js/19.64e06512.js"><link rel="prefetch" href="/myblog/assets/js/20.39c81836.js"><link rel="prefetch" href="/myblog/assets/js/21.0806872b.js"><link rel="prefetch" href="/myblog/assets/js/22.f81cf17f.js"><link rel="prefetch" href="/myblog/assets/js/23.22fe462b.js"><link rel="prefetch" href="/myblog/assets/js/24.b968d634.js"><link rel="prefetch" href="/myblog/assets/js/25.010651a6.js"><link rel="prefetch" href="/myblog/assets/js/26.331829be.js"><link rel="prefetch" href="/myblog/assets/js/27.0f7db951.js"><link rel="prefetch" href="/myblog/assets/js/28.3d1b2c5c.js"><link rel="prefetch" href="/myblog/assets/js/29.8ef373b3.js"><link rel="prefetch" href="/myblog/assets/js/30.57e49092.js"><link rel="prefetch" href="/myblog/assets/js/31.32f8e2a0.js"><link rel="prefetch" href="/myblog/assets/js/32.5e8d73e3.js"><link rel="prefetch" href="/myblog/assets/js/33.e9d2a5b9.js"><link rel="prefetch" href="/myblog/assets/js/34.8a5fcb0a.js"><link rel="prefetch" href="/myblog/assets/js/35.a9ec83ac.js"><link rel="prefetch" href="/myblog/assets/js/36.c286db67.js"><link rel="prefetch" href="/myblog/assets/js/4.ccc4afb9.js"><link rel="prefetch" href="/myblog/assets/js/5.4acb5796.js"><link rel="prefetch" href="/myblog/assets/js/7.6960cc93.js"><link rel="prefetch" href="/myblog/assets/js/8.22261383.js"><link rel="prefetch" href="/myblog/assets/js/9.f39a9d7e.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.8be25012.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>深渊里的小鱼</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>不断总结，才能进步！</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>深渊里的小鱼</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><img src="/myblog/logo.png" alt="深渊里的小鱼" class="logo"> <span class="site-name">深渊里的小鱼</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/categories/CSS/" class="nav-link"><i class="undefined"></i>
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/javascript/" class="nav-link"><i class="undefined"></i>
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/计算机网络/" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Vim/" class="nav-link"><i class="undefined"></i>
  Vim
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/数据结构与算法/" class="nav-link"><i class="undefined"></i>
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Languiyuan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/myblog/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    深渊里的小鱼
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>26</h3> <h6 data-v-828910c6>文章</h6></div> <div data-v-828910c6><h3 data-v-828910c6>14</h3> <h6 data-v-828910c6>标签</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/categories/CSS/" class="nav-link"><i class="undefined"></i>
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/javascript/" class="nav-link"><i class="undefined"></i>
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/计算机网络/" class="nav-link"><i class="undefined"></i>
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Vue/" class="nav-link"><i class="undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Vim/" class="nav-link"><i class="undefined"></i>
  Vim
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/数据结构与算法/" class="nav-link"><i class="undefined"></i>
  数据结构与算法
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Languiyuan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/blogs/Webpack/webpack.html" aria-current="page" class="active sidebar-link">webpack学习笔记</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>webpack学习笔记</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>深渊里的小鱼</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2022
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">webpack学习笔记</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>深渊里的小鱼</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>2021-7-28</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>Webpack</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h2> <h3 id="_1-打包过程"><a href="#_1-打包过程" class="header-anchor">#</a> 1. 打包过程</h3> <p>方式一命令行工具：</p> <p><code>webpack --entry ./src/main.js --output-path ./bulid</code></p> <p>方式二配置文件：<code>webpack.config.js</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'build.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果配置文件名不是<code>webpack.config.js</code></p> <p>解决方案：在配置文件种修改 build 指令的配置参数</p> <p><img src="/myblog/assets/img/26.26f6cb7c.png" alt="26"></p> <h3 id="_2-webpack-依赖关系图"><a href="#_2-webpack-依赖关系图" class="header-anchor">#</a> 2.webpack 依赖关系图</h3> <ul><li>webpack 到底是如何对我们的项目进行打包的呢？
<ul><li>事实上 webpack 处理应用程序时，根据命令或已配置的文件找到入口</li> <li>入口开始，生成一个 <strong>依赖关系图</strong>，这个依赖关系图会包含应用程序中所需的所有模块（js，css，图片，字体）</li> <li>遍历图结构，打包一个个模块（根据文件的不同使用不同的 loader 来解析）</li></ul></li> <li>上述的例子：
<ul><li>例子一：安装了某个第三方库<code>axios</code>，但是并没有使用，所以打包不会带进去，打包后总体积不会增大。</li> <li>例子二：项目中创建的文件，没有被引用，最后打包不会在依赖图上，所以体积也不会增大。</li> <li>例子三：假如有个 js 文件里面有函数，js 确实被引用了，但是函数未被执行，函数也不会被打包。
<ul><li>涉及到 tree shaking</li></ul></li></ul></li></ul> <h3 id="_3-代码编写案例"><a href="#_3-代码编写案例" class="header-anchor">#</a> 3.代码编写案例</h3> <ul><li><p>写了个 css，导入到文件，最后把它打包，最后会报错，原因是缺少加载 css 的 loader</p></li> <li><p>loader 是什么呢？</p> <ul><li>用于对模块的源代码进行替换</li> <li>css 文件也可以看成是一个模块，通过 <strong>import</strong>来加载这个模块</li> <li>在加载这个模块时，webpack 其实并不知道如何对其进行加载，我们必须制定对应的 loader 来完成这个功能</li></ul></li> <li><p>那么什么样的 loader 可以加载 css 呢？</p> <ul><li>这个常用的 loader 最常用的是 css-loader</li> <li>安装：<code>npm install css-loader -D</code></li></ul></li> <li><p>css-loader 的三种使用方案：</p> <ul><li>内联</li></ul> <p><img src="/myblog/assets/img/27.5cd507c5.png" alt="27"></p> <ul><li>CLI 方式（webpack5 中不再使用）</li> <li>配置方式</li></ul></li> <li><p>有<code>css-loader</code>表示正常处理解析了 css 文件，但是解析之后的 css 文件没有插入到页面上。</p></li> <li><p>想要插入 style，就需要使用<code>style-loader</code></p> <ul><li><code>npm i style-loader -D</code></li> <li>use: [&quot;style-loader&quot;]</li> <li>style-loader 的原理就是在 document.createElement(style)创建了个样式表</li></ul></li> <li><p>注意：<strong>webpack 处理 loader 的时候是从下往上的，从右往左的</strong></p></li></ul> <h3 id="_4-loader-配置方法"><a href="#_4-loader-配置方法" class="header-anchor">#</a> 4.loader 配置方法</h3> <ul><li><p>module.rules 的配置如下：</p></li> <li><p>rules 属性对应的值是一个数组 <strong>[Rule]</strong></p></li> <li><p>数组中存放的时 一个个的 Rule，Rule 是一个对象，对象中可以设置多个属性：</p> <ul><li><p>test 属性：用于对 resource（资源）进行匹配，通常设置成正则表达式</p></li> <li><p>use 属性：对应的值是一个数组：</p> <p>[UseEntry]</p> <p>，也是一个对象，有两个 key</p> <ul><li>loader：指明要用哪些 loader</li> <li>options：可选属性，值可以使字符串或对象，值会被传入到 loader 中</li></ul></li> <li><p><code>use:[&quot;css-loader&quot;]</code>相当于键值对的写法</p></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'build.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">/* {
        test: //.css$/, // 一般就是一个正则表达式，用于匹配我们所需要的文件类型
        use: [
          {
            loader: 'css-loader',
          },
        ],
      }, */</span>
      <span class="token comment">/* {
        test: /\.css$/,
        loader: 'css-loader',
      }, */</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="_5-如何处理-scss-文件"><a href="#_5-如何处理-scss-文件" class="header-anchor">#</a> 5.如何处理 scss 文件</h3> <p>安装 node-sass, 用于 把 scss 转化成 css（-D）</p> <p>还有就是 sass-loader（-D）</p> <p>配置 rule</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">// 从右到左，从下到上</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_6-postcss"><a href="#_6-postcss" class="header-anchor">#</a> 6.postcss</h3> <h4 id="_6-1-browserslist"><a href="#_6-1-browserslist" class="header-anchor">#</a> 6.1 browserslist</h4> <p>用来判断要兼容的浏览器有哪些，可以单独的 写配置文件，也可以放在 packjson 中。可以通过调用</p> <p><code>npx browserslist</code>,来查看需要兼容的浏览器</p> <p><img src="/myblog/assets/img/28.9f7c9f9c.png" alt="28"></p> <h4 id="_6-2-postcss-工具"><a href="#_6-2-postcss-工具" class="header-anchor">#</a> 6.2 postcss <strong>工具</strong></h4> <ul><li>什么是 PostCss？
<ul><li>PostCss 是通过<strong>JavaScript</strong>来<strong>转换样式</strong>的工具</li> <li>这个工具可以帮助我们进行 CSS 的转换和适配，比如自动添加浏览器前缀，css 样式重置
<ul><li>需要添加前缀的样式网站是：<code>autoprefixer.github.io</code></li></ul></li> <li>实现这些功能，都需要借助于 PostCSS 对应的插件</li></ul></li> <li>如何使用 PostCSS 呢？主要就是两个步骤：
<ul><li>先查找 PostCSS 在构建工具的扩展，比如 webpack 中的 postcss-loader；</li> <li>选择可以添加你需要的 PostCSS 相关插件</li></ul></li></ul> <h4 id="_6-3-命令行使用-postcss"><a href="#_6-3-命令行使用-postcss" class="header-anchor">#</a> 6.3 命令行使用 postcss</h4> <ul><li><p>我们可以直接在终端中使用 PostCSS，只需要单独安装一个工具</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>postcss-cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>npm i postcss -D</code></li> <li><code>npm i postcss-cli -D</code> 目的是为了能在命令行中使用 PostCSS</li></ul></li> <li><p>举个栗子：现在有个 css 文件里面有些样式，但是这些样式是需要加上浏览器前缀的</p> <ul><li>现在这些样式是不行的，需要进行处理才能正常运行</li> <li><code>npx postcss -o result.css ./src/css/test.css</code>（wrong）</li></ul></li></ul> <p><img src="/myblog/assets/img/29.2237787c.png" alt="29"></p> <p>postcss 本身是没有任何作用的，你要给他配上插件，他才能起作用，类似于多功能螺丝刀套装中的柄，要有头才能工作。</p> <p>想要自动添加前缀需要安装什么插件呢？</p> <ul><li><code>npm i autoprefixer -D</code> - 然后再执行的时候也需要告诉这次你要使用的插件 - <code>npx postcss --use autoprefixer -o result.css ./src/css/test.css</code></li></ul> <p><img src="/myblog/assets/img/30.f4a9c623.png" alt="30"></p> <h4 id="_6-4-在-webpack-中使用-postcss"><a href="#_6-4-在-webpack-中使用-postcss" class="header-anchor">#</a> 6.4 在 webpack 中使用 postcss</h4> <ul><li><p>大致流程就是我们需要把自己写的 css 通过 postcss 转换成有前缀的 result.css</p></li> <li><p>然后再交给 css-loader 处理，渲染</p></li> <li><p>首先需要安装</p></li></ul> <p>postcss-loader</p> <ul><li><p><code>npm i postcss-loader -D</code></p></li> <li><p>然后需要在 css-loader 之前通过 postcss-loader 处理</p> <ul><li>但要注意的是要使用对应的插件，上面也提到过</li></ul></li></ul> <p><img src="/myblog/assets/img/31.6e095cc1.png" alt="31"></p> <h4 id="_6-5-postcss-preset-env的使用"><a href="#_6-5-postcss-preset-env的使用" class="header-anchor">#</a> 6.5 <code>postcss-preset-env</code>的使用</h4> <p>这个相当于螺丝刀头的整个的套装，它同样包括了<code>autoprefixer</code></p> <ul><li><p>上面介绍了 <strong>autoprefixer</strong>，但是很多项目中使用更多的是 <strong>postcss-preset-env</strong></p></li> <li><p>他的作用也是转换 <strong>现代 css 特性</strong>，让这个 css 可以被大多数浏览器识别</p></li> <li><p>举个栗子：</p> <ul><li>我们一般写 16 进制颜色的时候写 6 位：如 <code>#123456</code>, 代表着 rgb</li> <li>但是我们写成 8 位 <code>#12345678</code> ,代表着 rgba，后面两个代表透明度</li> <li>但这个 8 位最新的浏览器确实可以解析，但是旧浏览器无法解析，而且上面使用的 <strong>autoprefixer</strong>也不会帮我们转换</li> <li>那怎么办? 答案就是使用 <strong>postcss-preset-env</strong></li></ul></li> <li><p>使用步骤：</p> <ul><li><p>安装： <code>npm i postcss-preset-env -D</code></p></li> <li><p>在 postcss-loader 中使用该插件</p> <p><img src="data:image/png;base64,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" alt="32"></p></li></ul></li></ul> <h4 id="_6-6-配置优化"><a href="#_6-6-配置优化" class="header-anchor">#</a> 6.6 配置优化</h4> <ul><li>在普通 css 中这样处理需要写一大推代码，项目中又有<code>scss</code>有需要写一遍相同的代码，有没有办法优化？</li> <li>将整个代码块直接改成像<code>css-loader</code>一样，写个字符串</li> <li>把相关的插件依赖写到<code>postcss.config.js</code>里面，名字一定是要这个，不然无法读取</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    pluginL <span class="token punctuation">[</span>
    	<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-preset-env'</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_6-7css使用-import-注意事项"><a href="#_6-7css使用-import-注意事项" class="header-anchor">#</a> 6.7<code>css</code>使用@import 注意事项</h4> <ul><li><p>有些场景是在一个样式中通过 <strong>@import</strong>引入另外一个 css 文件</p></li> <li><p>这种情况就不会被 <strong>postcss-loader</strong>处理，需要为 <strong>css-loader</strong>添加 **<code>importLoaders</code>**属性</p></li> <li><p>设置成 1 的的意思是，再遇到有引入的 css 文件，就会对这个文件进行往回走一步，处理再回来。</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	loader<span class="token operator">:</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
		importLoaders<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_7-处理其他资源"><a href="#_7-处理其他资源" class="header-anchor">#</a> 7.处理其他资源</h3> <h4 id="_7-1-file-loader"><a href="#_7-1-file-loader" class="header-anchor">#</a> 7.1 file-loader</h4> <ul><li><p>要处理一些图片格式文件，我门也要有对应的 loader： <code>file-loader</code></p></li> <li><p><code>file-loader</code>的作用就是，我们用<strong>import/require（）</strong> 方式引入一个文件资源的时候，会把它放到我们输出的文件夹</p></li> <li><p>安装： <code>npm i file-loader -D</code></p> <ul><li><p>使用 require 导入图片，此时如果不配置 esModule： false， 则需要。default 导出</p></li> <li><p>也可以在配置当中设置 esModule: false</p></li> <li><p>采用 import xxx from 图片资源， 此时可以直接使用 xxxx</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// @ts-ignore</span>
<span class="token keyword">import</span> imgSrc <span class="token keyword">from</span> <span class="token string">'../img/02.jpg'</span>

<span class="token keyword">function</span> <span class="token function">packImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> oEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> oImg <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
  oEle<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'test'</span>
  <span class="token comment">// @ts-ignore</span>
  <span class="token comment">//oImg.src = require('../img/02.jpg').default  // 返回一个对象，所以要加defalut</span>
  <span class="token comment">// oImg.src = require('../img/02.jpg')</span>
  oImg<span class="token punctuation">.</span>src <span class="token operator">=</span> imgSrc
  oEle<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>oImg<span class="token punctuation">)</span>
  <span class="token keyword">return</span> oEle
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">packImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>webpack.config.js</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|svg|gif|jpe?g)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
            <span class="token comment">/* options: {
              esModule: false, // 不转为esModule
            }, */</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h5 id="_7-1-2-图片资源重命名和对应目录"><a href="#_7-1-2-图片资源重命名和对应目录" class="header-anchor">#</a> 7.1.2 图片资源重命名和对应目录</h5> <p><strong>但是考虑一个问题，打包之后的图片资源名称是经 md4 加密后的哈希值，不方便 和原资源名称对应起来，想要对应起来，怎么做？</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif|svg)$</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&quot;[name].[hash:6].[ext]&quot;</span><span class="token punctuation">,</span>
          outputPath<span class="token operator">:</span> <span class="token string">'img'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//通过占位符</span>
<span class="token comment">//[ext] : 占位符</span>
<span class="token comment">//[name] : 文件名</span>
<span class="token comment">//[hash] : 文件内容</span>
<span class="token comment">//[hash:&lt;length&gt;] : 选取 hash 的前几位&lt;/length&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_7-2-url-loader"><a href="#_7-2-url-loader" class="header-anchor">#</a> 7.2 url-loader</h4> <p>url-loader 和 file-loader 工作方式相似，但是可以把较小的文件转化成 base64 的 URL</p> <p>安装： <code>npm i -url-loader -D</code></p> <p>配置：</p> <ul><li>不会像 <strong>file-loader</strong>一样去生成图片，而是转换成 <strong>base-64</strong>直接嵌入到 js 文件当中</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif|svg)$</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&quot;[name].[hash:6].[ext]&quot;</span><span class="token punctuation">,</span>
          outputPath<span class="token operator">:</span> <span class="token string">&quot;img&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="_7-2-1-url-loader-的问题"><a href="#_7-2-1-url-loader-的问题" class="header-anchor">#</a> 7.2.1 url-loader 的问题</h5> <ul><li>一般那适合小文件，这样也减少了网页请求的次数</li> <li>如果是大文件，把 base64 嵌入进去就会让文件很大</li> <li>首次加载会消耗更多的时间去加载这个 js 文件，造成白屏时间长</li></ul> <p>解决方法就是小文件转，大文件还是使用 file-loader，url-loader 是可以调用 file-loader 的；使用一个 limit 配置，作为文件大小的分界线</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>	<span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|svg|gif|jpe?g)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token comment">//esModule: false, // 不转为esModule</span>
              name<span class="token operator">:</span> <span class="token string">'[name].[hash:6].[ext]'</span><span class="token punctuation">,</span>
              limit<span class="token operator">:</span> <span class="token number">25</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
              outputPath<span class="token operator">:</span> <span class="token string">'img'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_7-3-asset-webpack5-新特性"><a href="#_7-3-asset-webpack5-新特性" class="header-anchor">#</a> 7.3 asset(webpack5 新特性)</h4> <p>在 webpack5 之前，会使用到 <strong>raw-loader</strong>、 <strong>url-loader</strong>、 <strong>file-loader</strong>。但是 webpack5 出来之后，我们可以直接使用资源模块类型（asset module type），来替代上面这些 loader</p> <p><strong>资源模块类型（asset module type）</strong>，通过添加 4 种薪的模块类型，来替换所有这些 loader：</p> <ul><li><strong>asset/resource</strong> 发送单独的文件并导出 URL。之前对应的是 <strong>file-loader</strong></li> <li><strong>asset/inline</strong> 导出一个资源的 data URI。之前通过使用 <strong>url-loader</strong>实现</li> <li><strong>asset/source</strong>导出资源的源代码。之前对应 <strong>raw-loader</strong></li> <li><strong>asset</strong>在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过 <strong>url-loader</strong>，并且配置资源体积限制实现。</li></ul> <h5 id="_7-3-1-使用-asset-module-type"><a href="#_7-3-1-使用-asset-module-type" class="header-anchor">#</a> 7.3.1 使用 asset module type</h5> <p>无需安装，webpack 内置</p> <p>配置代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif|svg)$</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>指定目录的存放方式</p> <p><strong>方式一：</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;boundle.js&quot;</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./build&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    assetModuleFilename<span class="token operator">:</span> <span class="token string">&quot;img/[name].[hash:6][ext]&quot;</span>  <span class="token comment">// 和file-loader不一样的地方，扩展名之前少一个.，模块帮我们加过了</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>方式二（在 generator 属性中设置）:</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token punctuation">{</span>
    test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif|svg)$</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
    generator<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&quot;img/[name].[hash:6][ext]&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>大图片小图片采用不同的 type</p> <ul><li>就是把大图片带走打包，小图片就转换为 base64 嵌入行内；</li> <li>直接把 <strong>type 类型设置为 asset</strong></li> <li>设置 parser 属性中的 maxSize</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token punctuation">{</span>
    test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif|svg)$</span><span class="token regex-delimiter">/</span></span> <span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 二选一打包</span>
    generator<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&quot;img/[name].[hash:6][ext]&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    parser<span class="token operator">:</span> <span class="token punctuation">{</span>
      dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
        maxSize<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span><span class="token number">1024</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_7-4-加载字体"><a href="#_7-4-加载字体" class="header-anchor">#</a> 7.4 加载字体</h4> <p>很多场景下都会使用到特殊的字体或者字体图标，就会引入很多字体相关的文件，这些文件的处理方式都是一样的。</p> <p>在 webpack5 之前也是通过 file-loader 来处理，但是在 webpack5 中就完全没必要了。</p> <p>代码配置</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.ttf|eot|woff2?$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
    generator<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">&quot;font/[name].[hash:6][ext]&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_8-plugin"><a href="#_8-plugin" class="header-anchor">#</a> 8 plugin</h3> <h4 id="_8-1-plugin-和-loader-的区别"><a href="#_8-1-plugin-和-loader-的区别" class="header-anchor">#</a> 8.1 plugin 和 loader 的区别</h4> <ul><li>loader 是用于·特定模块类型的转换，对那些资源经行预处理</li> <li>plugin 用于执行更加广泛的任务，比如打包优化，资源管理，环境变量注入。在 webpack 运行过程中生命周期中会广播很多事件，plugin 通过监听这些事件，然后调用 webpack 提供的 api 来改变输出结果</li> <li>还有就是配置方法不一样，loader 实在 module.rules 中配置，不同类型资源（test）可能会用到多个 loader（use）。plugin 是在 plugins 中配置的，类型为数组，每一项都是 plugin 的实例，传递参数通过构造函数传入。</li></ul> <p>举例说明：</p> <ul><li><p>css 文件需要用到 css-loader 去加载</p></li> <li><p>但是多个 css 文件合并就需要用到插件</p> <p><img src="/myblog/assets/img/33.9a2576d1.png" alt="33"></p></li></ul> <p><code>plugin</code> 例子</p> <ul><li>不经过特殊处理的话，每次打包后的 build 文件夹，同名称的文件会被覆盖，但是多余文件不会被删除，</li> <li>想要它删除多余文件，也就是重新生成新的 build 文件夹，该怎么做？</li></ul> <p>安装 <code>npm i clean-webpack-plugin -D</code></p> <p>导入 <code>const { CleanWebpackPlugin } = require('clean-webpack-plugin')</code></p> <p>配置代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_8-2-htmlwebpackplugin"><a href="#_8-2-htmlwebpackplugin" class="header-anchor">#</a> 8.2 HtmlWebpackPlugin</h4> <p>在 dist 中自动生成 html 文件</p> <p>安装： <code>npm i html-webpack-plugin -D</code></p> <p>配置代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'coderqmj webpcak app'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>这样做的话就可以打包之后在 build 生成 HTML 文件，根据模板引擎生成</li> <li>但是某些特除场景下提供的模板引擎无法满足需求，如 vue 中是需要把 组件挂载到<code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code>中的</li> <li>所以我们还需要自定义模板引擎</li></ul> <h5 id="_8-2-1-自定义模板引擎"><a href="#_8-2-1-自定义模板引擎" class="header-anchor">#</a> 8.2.1 自定义模板引擎</h5> <p>首先需要在根目录下创建 public 目录，在里面创建 index.html</p> <p>配置代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'coderqmj webpcak app'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token string">'./public/index.html'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_8-3-定义全局常量-defineplugin"><a href="#_8-3-定义全局常量-defineplugin" class="header-anchor">#</a> 8.3 定义全局常量 DefinePlugin</h4> <p>这是一个内置插件，无需安装直接引入</p> <p>配置代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 导入</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">'&quot;./&quot;'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_8-4-copywebpckplugin"><a href="#_8-4-copywebpckplugin" class="header-anchor">#</a> 8.4 CopyWebpckPlugin</h4> <p>安装 <code>npm i copy-webpack-plugin -D</code></p> <p>配置</p> <ul><li><p>这样做技能复制 public 下面的文件，也能忽略复制对应的文件</p></li> <li><p>需要注意的是，忽略配置的形式是 <code>**/文件名</code></p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 导入</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  patterns<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      from<span class="token operator">:</span> <span class="token string">&quot;public&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 从这个地方复制，to是默认在build文件夹下面的</span>
      globOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        ignore<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;**/index.html&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_9-babel"><a href="#_9-babel" class="header-anchor">#</a> 9 Babel</h3> <h4 id="_9-1-简单介绍"><a href="#_9-1-简单介绍" class="header-anchor">#</a> 9.1 简单介绍</h4> <p><strong>为什么需要 babel？</strong></p> <ul><li>在编码中，很少接触 babel，但是对于前端开发来说，这是不可获取的</li> <li>我们想要在项目中使用 ES6，TS，开发 Vue 项目，都是离不开 babel 转换的</li> <li>所以，学习 babel 对于我们理解代码从编写到上限的转变过程至关重要</li></ul> <p><strong>那 babel 到底是什么？</strong></p> <ul><li>babel 是一个工具链，主要用于旧浏览器或者缓解中将 ES2015+代码转换为向后兼容版本的 JS</li> <li>包括语法转换、源代码转换、Polyfill 实现目标缓解缺少的功能等</li></ul> <h4 id="_9-2-babel-的使用"><a href="#_9-2-babel-的使用" class="header-anchor">#</a> 9.2 Babel 的使用</h4> <p>原文件</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 源文件</span>
<span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token string">'Hello World'</span>

<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>安装： <code>npm i @babel/core -D</code></p> <p>在命令行使用 babel： <code>npm i @babel/cli -D</code></p> <p>babel 输出： <code>npx babel src/index.js --out-dir result</code></p> <p>以上操作的结果是不能转换箭头函数的，跟 postcss 一样，babel 只是螺丝柄，他需要各种各样的螺丝头（插件）。</p> <p>箭头函数转换插件： <code>npm i @babel/plugin-transform-arrow-functions -D</code></p> <p>块级作用域转换插件： <code>npm i @babel/plugin-transform-block-scoping -D</code></p> <p>使用命令上：<code>npx babel src/index.js --out-dir result --plugins=@babel/plugin-transform-arrow-functions,@babel/plugin-transform-block-scoping</code></p> <p>9.2.1 babel 的预设（preset-env）</p> <p>那么问题来了，ES6 这么多需要转换的，难道都需要一个个写吗？</p> <p>当然不是，跟 postcss 一样，会有一个预设，包含了所有的插件</p> <ul><li><p><strong>安装预设</strong> ： <code>npm i @babel/preset-env -D</code></p></li> <li><p><strong>使用预设</strong> ： <code>npx babel src --out-dir result --presets=@babel/preset-env</code></p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token string">'use strict'</span>

<span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">'Hello World'</span>

<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_9-3-babel-loader"><a href="#_9-3-babel-loader" class="header-anchor">#</a> 9.3 babel-loader</h4> <p>安装：<code>npm install -D babel-loader @babel/core @babel/preset-env</code></p> <p>配置：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>	<span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>单独的<code>babel.config.js</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_9-4-polyfill"><a href="#_9-4-polyfill" class="header-anchor">#</a> 9.4 polyfill</h4> <p>帮助我们更好的使用 JavaScript，我们使用了一些特性如，promise，generator，以及实例 Array.prototype.includes 等，但是某些浏览器不认识这些特性，就会报错，这时候我们使用 polyfill 来填充打补丁，就会包含该特性了。在 webpack4 中会把这些都直接加上，但是 webpack5 中这些根据自己的需求加上。</p> <p><a href="https://github.com/zloirock/core-js#babelpolyfill" target="_blank" rel="noopener noreferrer">zloirock/core-js: Standard Library (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>在 webpack5 中，安装两个包</p> <p><code>npm i core-js regenerator-runtime</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        targets<span class="token operator">:</span> <span class="token string">'defaults'</span><span class="token punctuation">,</span>
        <span class="token comment">// 默认false， 表示不对当前的js处理进行polyfill填充</span>
        <span class="token comment">// usage 依据用户源代码中的所使用的语法进行填充</span>
        <span class="token comment">// entry  根据borwserslist来，看浏览器要求来填充</span>
        useBuiltIns<span class="token operator">:</span> <span class="token string">'entry'</span><span class="token punctuation">,</span>
        corejs<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>使用 entry 在入口文件那要加上</p> <p><code>import 'core-js/stable'</code> <code>import 'regenerator-runtime/runtime'</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">'core-js/stable'</span>
<span class="token keyword">import</span> <span class="token string">'regenerator-runtime/runtime'</span>

<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token string">'yky'</span>

<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_9-5-babel-的原理"><a href="#_9-5-babel-的原理" class="header-anchor">#</a> 9.5 babel 的原理</h4> <p>babel 分成三部分</p> <ul><li><p>解析：将代码转化成 AST（抽象语法树）</p> <ul><li>词法分析：将代码（字符串）分割成 token 流，即语法单元成的数组</li> <li>语法分析： 分析 token 流（上面生成的数组）并生成 AST</li></ul></li> <li><p>转换： 访问 AST 的节点进行转换变换操作，生产新的 AST</p></li> <li><p>生成：以新的 AST 为基础生成代码</p> <p><img src="/myblog/assets/img/36.7ef89e82.jpg" alt="36"></p></li></ul> <p><strong>先看下 JS 执行过程</strong> ：源代码 -&gt; AST（abstract syntax tree） -&gt; ByteCode -&gt; 被 V8 引擎处理执行</p> <p><strong>我们把帮我们完成上面这一系列操作的叫做编译器，最主要帮我们做三个操作</strong></p> <ul><li>对代码进行解析生成 AST，AST 之后再对代码进行转换，生成另外一种代码，如字节码，也有可能是另外一中代码
<ul><li>源码是 ES6 的，生成原 AST，再生成新 AST 树，再生成 ES5 的代码</li> <li>这个过程就是 babel 帮我们完成</li></ul></li></ul> <p><strong>babel 如何做到把我们的代码（ES6，TS，JSX）转成 ES5 代码的？</strong></p> <ul><li><p>源一中源码（原生语言）转换成另外一种源码（目标语言），有这种功能的工具叫什么呢？</p></li> <li><p>这个就叫做编译器，事实上我们可以把 babel 看成就是一个编译器</p></li> <li><p>babel 编译器的作用就是将我们的源代码，转换成浏览器可以直接识别的另外一段源代码</p></li></ul> <p><strong>babel 的编译器工作流程</strong></p> <ul><li><p>解析阶段</p></li> <li><p>转换阶段</p></li> <li><p>生成阶段</p></li> <li><p>总结一下就是： 源代码 -&gt; 解析 -&gt; 转换 -&gt; 代码生成 -&gt; 目标代码 （大致过程）</p></li> <li><p>详细流程：</p> <p><img src="/myblog/assets/img/36.ec85b35e.png" alt="36"></p></li></ul> <p><strong>下面就根据一段代码来分析下整个编译流程</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 原生代码文件</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'coderwhy'</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token function">foo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>开始词法分析，像 const name = 字符串会被一个个提取出来</li> <li>这些词提取出来会生成 tokens 数组</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">;</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Keyword'</span><span class="token punctuation">,</span> <span class="token comment">// 关键字</span>
    value<span class="token operator">:</span> <span class="token string">'const'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span> <span class="token comment">// 标识符</span>
    value<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span> <span class="token comment">// 括号，等号，分号，逗号都叫这个</span>
    value<span class="token operator">:</span> <span class="token string">'='</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'('</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">')'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'=&gt;'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'console'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'.'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'log'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'('</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">')'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">';'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Identifier'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'('</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">'&quot;coderwhy&quot;'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">')'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'Punctuator'</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">';'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><ul><li>再然后就是语分析
<ul><li>怎么分析呢？就是拿到这个 tokens 数组进行遍历</li> <li>判断当前的值是个“const”的话，就知道它定义个变量</li> <li>这个过程也叫做 Parsing</li></ul></li> <li>经过各种分析之后，就会生成 AST，抽象语法树长什么样呢？
<ul><li>最外层有一些信息，type 存放 Program，</li> <li>body 存放着一些代码信息，比如定义了一个 foo 标识符，初始化为箭头函数</li></ul></li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;declarations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclarator&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;init&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ArrowFunctionExpression&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemberExpression&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;computed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token property">&quot;object&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;console&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;property&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;log&quot;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;generator&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;async&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;const&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ExpressionStatement&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coderwhy&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;coderwhy\&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><ul><li>然后就是对上面这个 AST 进行遍历，深度优先</li> <li>去访问这个树上的每一个节点</li> <li>然后在访问的过程中应用每一个插件对代码进行转换，对某些节点进行修改（插件就是在这个过程中被应用的）</li> <li>访问完每一个节点并且应用插件修改完之后，就会生成一个新的 AST</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Program&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclaration&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;declarations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VariableDeclarator&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">&quot;init&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FunctionExpression&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
              <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BlockStatement&quot;</span><span class="token punctuation">,</span>
              <span class="token string">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                  <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ReturnStatement&quot;</span><span class="token punctuation">,</span>
                  <span class="token string">&quot;argument&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MemberExpression&quot;</span><span class="token punctuation">,</span>
                      <span class="token string">&quot;computed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                      <span class="token string">&quot;object&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;console&quot;</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token string">&quot;property&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;log&quot;</span>
                      <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                      <span class="token punctuation">{</span>
                        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
                        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name&quot;</span>
                      <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">&quot;generator&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token string">&quot;async&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;var&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ExpressionStatement&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;expression&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CallExpression&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;callee&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Identifier&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;foo&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;arguments&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Literal&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coderwhy&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;raw&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;coderwhy\&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><ul><li>然后再根据这个新的 AST 生成 ES5 的代码</li></ul> <h3 id="_10-热更新"><a href="#_10-热更新" class="header-anchor">#</a> 10 热更新</h3> <p>方式一： 在<code>packjson</code>中脚本添加<code>--watch</code> 使用浏览器的 live server</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config wk.config.js --watch&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>方式二：在 webpack 配置文件中天添加：<code>watch:true</code> 使用浏览器的 live server</p> <p>缺点：</p> <ul><li><p>这两个方式性能消耗大，有修改所有的源代码都会被编译。编译成功时候，都会进行文件读写。</p></li> <li><p>不能进行局部的更新，例如就一个组件被更新了，他就会全部的更新</p></li></ul> <p>方式三：webpack-dev-server</p> <p>安装： <code>npm i webpack-dev-server -D</code></p> <p><img src="/myblog/assets/img/34.045c507a.png" alt="34"></p> <p>要注意的就是入口文件要是 index.js</p> <p>这个插件会帮忙建立一个静态服务器</p> <h4 id="_10-1-模块热替换-hot-module-replacement"><a href="#_10-1-模块热替换-hot-module-replacement" class="header-anchor">#</a> 10.1 模块热替换(hot module replacement)</h4> <p>模块热替换(HMR - hot module replacement)功能会在应用程序运行过程中，替换、添加或删除 <a href="https://webpack.docschina.org/concepts/modules/" target="_blank" rel="noopener noreferrer">模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，而无需重新加载整个页面。主要是通过以下几种方式，来显著加快开发速度：</p> <ul><li>保留在完全重新加载页面期间丢失的应用程序状态。</li> <li>只更新变更内容，以节省宝贵的开发时间。</li> <li>在源代码中 CSS/JS 产生修改时，会立刻在浏览器中进行更新，这几乎相当于在浏览器 devtools 直接更改样式。</li></ul> <p><img src="/myblog/assets/img/35.f3279267.png" alt="35"></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./js/title.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>选取要热更新的模块，就可以实现，单独的模块的更新，而不是刷新页面了。</p> <h3 id="_11-source-map"><a href="#_11-source-map" class="header-anchor">#</a> 11 source-map</h3> <p><code>source map</code> 是将编译、打包、压缩后的代码映射回源代码的过程。打包压缩后的代码不具备良好的可读性，想要调试源码就需要 soucre map。</p> <p>map 文件只要不打开开发者工具，浏览器是不会加载的。</p> <p>线上环境一般有三种处理方案：</p> <ul><li><code>hidden-source-map</code>：借助第三方错误监控平台 Sentry 使用</li> <li><code>nosources-source-map</code>：只会显示具体行数以及查看源代码的错误栈。安全性比 sourcemap 高</li> <li><code>sourcemap</code>：通过 nginx 设置将 .map 文件只对白名单开放(公司内网)</li></ul> <p>注意：避免在生产中使用 <code>inline-</code> 和 <code>eval-</code>，因为它们会增加 bundle 体积大小，并降低整体性能。</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022-7-10 10:50:51 ├F10: PM┤</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#webpack" class="sidebar-link reco-side-webpack" data-v-70334359>webpack</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_1-打包过程" class="sidebar-link reco-side-_1-打包过程" data-v-70334359>1. 打包过程</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_2-webpack-依赖关系图" class="sidebar-link reco-side-_2-webpack-依赖关系图" data-v-70334359>2.webpack 依赖关系图</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_3-代码编写案例" class="sidebar-link reco-side-_3-代码编写案例" data-v-70334359>3.代码编写案例</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_4-loader-配置方法" class="sidebar-link reco-side-_4-loader-配置方法" data-v-70334359>4.loader 配置方法</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_5-如何处理-scss-文件" class="sidebar-link reco-side-_5-如何处理-scss-文件" data-v-70334359>5.如何处理 scss 文件</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_6-postcss" class="sidebar-link reco-side-_6-postcss" data-v-70334359>6.postcss</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_7-处理其他资源" class="sidebar-link reco-side-_7-处理其他资源" data-v-70334359>7.处理其他资源</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_8-plugin" class="sidebar-link reco-side-_8-plugin" data-v-70334359>8 plugin</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_9-babel" class="sidebar-link reco-side-_9-babel" data-v-70334359>9 Babel</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_10-热更新" class="sidebar-link reco-side-_10-热更新" data-v-70334359>10 热更新</a></li><li class="level-3" data-v-70334359><a href="/myblog/blogs/Webpack/webpack.html#_11-source-map" class="sidebar-link reco-side-_11-source-map" data-v-70334359>11 source-map</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/myblog/assets/js/app.2ab9c80a.js" defer></script><script src="/myblog/assets/js/3.5cd8e1a2.js" defer></script><script src="/myblog/assets/js/1.646cc11f.js" defer></script><script src="/myblog/assets/js/6.bed8806e.js" defer></script>
  </body>
</html>
